import{b as D}from"./heading_modal-8cb43ed1.js";import{bB as U,bI as V,bG as w,bJ as R,aM as h,az as l,q as i,r as a,F as c,aK as v,a_ as g,y as F,p as b,bu as I,bi as k,aj as x,bx as y,z as n,aD as S,aA as L,x as N,aH as A}from"./index-3afa6c13.js";import{i as M}from"./input-e668dea8.js";import{b as j}from"./simple-2283d124.js";import{S as T}from"./select-ab6ad5d3.js";import{S as q}from"./delete-6aebbd9b.js";import{f as P}from"./search-e618f654.js";import"./defineProperty-b185edd1.js";const B={emits:["data-updated"],components:{input_text:M,button_simple:j,SelectDropdown:T,Supprimer:q},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,formData:{id:null,ClientId:"",VilleId:"",Livre:"",Refuse:"",Retourne:""},isEditMode:!1,data:[],tableFields:[],module:[],delete_row_id:"",deletedRow:"",loading:!1}},props:{apiUrl:{type:String,required:!0},filters_update:{type:String,required:!0},hidden_columns:{type:Object,required:!0}},methods:{loadPage(o){this.page=o;let e;this.filters?e=this.filters+"&page="+this.page+"&per_page="+this.per_page:e="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(e)},pageCount(){let o;this.filters?o=this.filters+"&page="+this.page+"&per_page="+this.per_page:o="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(o),console.log(o)},async submitFormUpdate(){const o=this.formData.id;console.log(o),console.log(this.formData);const e=await V(`https://api.gestion-livraison.pro/api/customer/fees/${o}/update`,this.formData);if(e.data){this.formData={id:"",ClientId:"",VilleId:"",Livre:"",Refuse:"",Retourne:""},$("#modalUpdate").modal("hide");const p=this.data.findIndex(s=>s.id===e.data.id);p!==-1&&(this.data[p]={...this.data[p],...e.data})}const r=this.data.findIndex(p=>p.id===e.data.id);r!==-1&&(this.data[r]={...this.data[r],...e.data})},async submitFormAdd(){const o=await w("https://api.gestion-livraison.pro/api/customer/fees/new",this.formData);console.log(o),o.data&&(this.formData={id:"",ClientId:"",VilleId:"",Livre:"",Refuse:"",Retourne:""},$("#modalAdd").modal("hide"),this.data.push(o.data))},openUpdateModal(o){this.formData={...o},$("#modalUpdate").modal("show")},async getFetchData(o=null){this.loading=!0;const e=await R(this.apiUrl+o);this.data=e.data,this.pagination=e.pagination,this.data.length>0&&(this.tableFields=Object.keys(e.data[0]),this.tableFields=this.tableFields.filter(r=>!this.hidden_columns.includes(r))),this.loading=!1}},mounted(){this.getFetchData("")},watch:{filters_update(o){this.page=1,this.filters=o,this.getFetchData(o)},deletedRow(o){const e=this.data.findIndex(r=>r.id===parseInt(o));e!==-1&&this.data.splice(e,1)}}},m=o=>(S("data-v-fd5ff232"),o=o(),L(),o),z={key:0,class:"table-responsive"},E={class:"table table-bordered"},H={class:"bg-light"},O=m(()=>a("th",null,"Action",-1)),G={class:"header_side"},J={key:0},K={class:"table_actions"},Q={class:"d-flex align-items-center order-actions"},W=["onClick"],X=m(()=>a("i",{class:"fas fa-pencil-alt"},null,-1)),Y=[X],Z=["onClick"],ee=m(()=>a("i",{class:"fas fa-trash-alt"},null,-1)),te=[ee],ae={class:"row d-flex justify-content-between align-items-center"},se={class:"col-md-1"},oe=N('<option value="10" data-v-fd5ff232>10</option><option value="20" data-v-fd5ff232>20</option><option value="50" data-v-fd5ff232>50</option><option value="100" data-v-fd5ff232>100</option><option value="200" data-v-fd5ff232>200</option><option value="500" data-v-fd5ff232>500</option><option value="1000" data-v-fd5ff232>1000</option>',7),le=[oe],ie={class:"col-md-6 d-flex justify-content-end align-items-center"},ne={class:"pagination d-flex align-items-end"},de={key:0,class:"page-item"},re=["onClick"],pe={key:1,class:"page-item"},ue={key:1,class:"d-flex justify-content-center py-4 bg-light"},me=m(()=>a("span",{class:"loader"},null,-1)),fe=[me],ce={key:2,class:"p-3 text-center bg-light"},_e=m(()=>a("p",null,"no-data",-1)),ve=[_e],ge={id:"modalUpdate",class:"modal fade",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},he={class:"modal-dialog"},be={class:"modal-content"},ye=m(()=>a("div",{class:"modal-header"},[a("h5",{class:"modal-title mt-0",id:"myModalLabel"},"Modifier Tarif Client"),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Ce={class:"modal-body"},De={class:"row"},Ue=m(()=>a("div",{class:"modal-footer"},[a("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),a("button",{type:"submit",class:"btn btn-primary waves-effect waves-light","data-bs-dismiss":"modal"},"Modifier")],-1)),Ve={id:"modalAdd",class:"modal fade",tabindex:"-1","aria-labelledby":"modalAdd","aria-hidden":"true"},we={class:"modal-dialog"},Re={class:"modal-content"},Fe=m(()=>a("div",{class:"modal-header"},[a("h5",{class:"modal-title mt-0",id:"modalAdd"},"Nouvelle Tarif Client"),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Ie={class:"modal-body"},ke={class:"row"},xe=m(()=>a("div",{class:"modal-footer"},[a("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),a("button",{type:"submit",class:"btn btn-primary waves-effect waves-light","data-bs-dismiss":"modal"},"Ajouter")],-1));function Se(o,e,r,p,s,d){const _=h("SelectDropdown"),f=h("input_text"),C=h("Supprimer");return l(),i(c,null,[s.data.length>0?(l(),i("div",z,[a("table",E,[a("thead",H,[a("tr",null,[(l(!0),i(c,null,v(s.tableFields,t=>(l(),i("th",{key:t},g(t),1))),128)),O])]),a("tbody",null,[(l(!0),i(c,null,v(s.data,t=>(l(),i("tr",{key:t.id},[(l(!0),i(c,null,v(s.tableFields,u=>(l(),i("td",{key:u},[a("span",G,g(u)+" : ",1),F(" "+g(t[u])+" ",1),u==="Livre"||u==="Retourne"||u==="Refuse"?(l(),i("span",J," DH")):b("",!0)]))),128)),a("td",K,[a("div",Q,[a("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:u=>d.openUpdateModal(t)},Y,8,W),a("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:u=>{s.delete_row_id=t.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},te,8,Z)])])]))),128))])]),a("div",ae,[a("div",se,[I(a("select",{class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>s.per_page=t),onChange:e[1]||(e[1]=(...t)=>d.pageCount&&d.pageCount(...t))},le,544),[[k,s.per_page]])]),a("nav",ie,[a("ul",ne,[s.pagination.current_page>1?(l(),i("li",de,[a("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=t=>d.loadPage(s.pagination.current_page-1))},"Précédent")])):b("",!0),(l(!0),i(c,null,v(s.pagination.last_page,t=>(l(),i("li",{class:x(["page-item",{active:t===s.pagination.current_page}]),key:t},[a("a",{class:"page-link",href:"#",onClick:u=>d.loadPage(t)},g(t),9,re)],2))),128)),s.pagination.current_page<s.pagination.last_page?(l(),i("li",pe,[a("a",{class:"page-link",href:"#",onClick:e[3]||(e[3]=t=>d.loadPage(s.pagination.current_page+1))},"Suivant")])):b("",!0)])])])])):s.loading?(l(),i("div",ue,fe)):(l(),i("div",ce,ve)),a("div",ge,[a("form",{onSubmit:e[12]||(e[12]=y((...t)=>d.submitFormUpdate&&d.submitFormUpdate(...t),["prevent"]))},[a("div",he,[a("div",be,[ye,a("div",Ce,[n(_,{value:s.formData.VilleId,apiUrl:"https://api.gestion-livraison.pro/api/cities",fieldName:"Nom",first_option:"Selectionner une Ville",label:"Ville",Class_Content:"col-md-12 mt-4","onUpdate:value":e[4]||(e[4]=t=>s.formData.VilleId=t)},null,8,["value"]),n(_,{value:s.formData.ClientId,apiUrl:"https://api.gestion-livraison.pro/api/customers",fieldName:"Nom",first_option:"Selectionner un Client",label:"Clients",Class_Content:"col-md-12 mt-4","onUpdate:value":e[5]||(e[5]=t=>s.formData.ClientId=t)},null,8,["value"]),a("div",De,[n(f,{modelValue:o.Livre,"onUpdate:modelValue":e[6]||(e[6]=t=>o.Livre=t),label:"Frais livré",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Livre,"onUpdate:value":e[7]||(e[7]=t=>s.formData.Livre=t)},null,8,["modelValue","value"]),n(f,{modelValue:o.Refuse,"onUpdate:modelValue":e[8]||(e[8]=t=>o.Refuse=t),label:"Frais refusé",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Refuse,"onUpdate:value":e[9]||(e[9]=t=>s.formData.Refuse=t)},null,8,["modelValue","value"]),n(f,{modelValue:o.Retourne,"onUpdate:modelValue":e[10]||(e[10]=t=>o.Retourne=t),label:"Frais Retourne",type:"text",Class_Content:"col-md-12 mt-4",value:s.formData.Retourne,"onUpdate:value":e[11]||(e[11]=t=>s.formData.Retourne=t)},null,8,["modelValue","value"])])]),Ue])])],32)]),a("div",Ve,[a("form",{onSubmit:e[21]||(e[21]=y((...t)=>d.submitFormAdd&&d.submitFormAdd(...t),["prevent"]))},[a("div",we,[a("div",Re,[Fe,a("div",Ie,[n(_,{value:s.formData.VilleId,apiUrl:"https://api.gestion-livraison.pro/api/cities",fieldName:"Nom",first_option:"Selectionner une Ville",label:"Ville",Class_Content:"col-md-12 mt-4","onUpdate:value":e[13]||(e[13]=t=>s.formData.VilleId=t)},null,8,["value"]),n(_,{value:s.formData.ClientId,apiUrl:"https://api.gestion-livraison.pro/api/customers",fieldName:"Nom",first_option:"Selectionner un Client",label:"Clients",Class_Content:"col-md-12 mt-4","onUpdate:value":e[14]||(e[14]=t=>s.formData.ClientId=t)},null,8,["value"]),a("div",ke,[n(f,{modelValue:o.Livre,"onUpdate:modelValue":e[15]||(e[15]=t=>o.Livre=t),label:"Frais livré",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Livre,"onUpdate:value":e[16]||(e[16]=t=>s.formData.Livre=t)},null,8,["modelValue","value"]),n(f,{modelValue:o.Refuse,"onUpdate:modelValue":e[17]||(e[17]=t=>o.Refuse=t),label:"Frais refusé",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Refuse,"onUpdate:value":e[18]||(e[18]=t=>s.formData.Refuse=t)},null,8,["modelValue","value"]),n(f,{modelValue:o.Retourne,"onUpdate:modelValue":e[19]||(e[19]=t=>o.Retourne=t),label:"Frais Retourne",type:"text",Class_Content:"col-md-12 mt-4",value:s.formData.Retourne,"onUpdate:value":e[20]||(e[20]=t=>s.formData.Retourne=t)},null,8,["modelValue","value"])])]),xe])])],32)]),n(C,{apiUrl:`https://api.gestion-livraison.pro/api/customer/fees/${s.delete_row_id}/delete`,onDeletedId:e[22]||(e[22]=t=>s.deletedRow=t)},null,8,["apiUrl"])],64)}const Le=U(B,[["render",Se],["__scopeId","data-v-fd5ff232"]]),Ne={class:"main-content"},Ae={class:"page-content"},Me={class:"container-fluid"},je={class:"card"},Te={class:"card-body"},qe={class:"mb-3"},Ke={__name:"customer_fees",setup(o){const e=A(null);return(r,p)=>(l(),i("div",Ne,[a("div",Ae,[a("div",Me,[n(D,{pageTitle:"Clients Tarifs",toggle:"modal",target:"#modalAdd",modalText:"Nouveau Tarif"}),a("div",je,[a("div",Te,[a("div",qe,[n(P,{placeholder:"Rechercher par Motcle",onFilterUpdated:p[0]||(p[0]=s=>e.value=s),filters_fields:"customer,city"})]),n(Le,{apiUrl:"https://api.gestion-livraison.pro/api/customers/fees",filters_update:e.value,hidden_columns:"id"},null,8,["filters_update"])])])])])]))}};export{Ke as default};
