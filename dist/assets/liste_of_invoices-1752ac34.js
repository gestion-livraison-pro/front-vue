import{bB as w,bD as R,bI as b,bL as D,bJ as M,bT as x,aM as m,az as a,q as r,r as e,p as _,F as f,aK as y,y as p,a_ as c,o as C,aj as k,bu as S,bi as U,z as h,aD as q,aA as I,x as F,aH as P}from"./index-3afa6c13.js";import{c as L}from"./check-fe9a82f7.js";import{S as N}from"./delete-6aebbd9b.js";import{h as B}from"./heading-f00730b6.js";import{f as j}from"./search-e618f654.js";import"./select-ab6ad5d3.js";import"./defineProperty-b185edd1.js";const G={components:{checkd:L,Supprimer:N},props:{apiUrl:{type:String,required:!0},requiredModule_Cloturé:{type:String},requiredModule_Versé:{type:String},filters_update:{type:String,required:!0}},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,data:[],close:{Cloturé:""},paid:{Versé:""},Role:R(),delete_row_id:"",deletedRow:"",loading:!1}},mounted(){this.getFetchData("")},methods:{loadPage(o){this.page=o;let t;this.filters?t=this.filters+"&page="+this.page+"&per_page="+this.per_page:t="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(t)},pageCount(){let o;this.filters?o=this.filters+"&page="+this.page+"&per_page="+this.per_page:o="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(o),console.log(o)},async toggleCloture(o){o.Cloturé=o.Cloturé===1?0:1,await b(`https://api.gestion-livraison.pro/api/delivery/invoice/${o.id}/close/update`,{Cloturé:o.Cloturé})},async togglepaid(o){o.Versé=o.Versé===1?0:1,await b(`https://api.gestion-livraison.pro/api/delivery/invoice/${o.id}/paid/update`,{Versé:o.Versé})},checkModule(o){const t=D(o);return console.log(t),t},async getFetchData(o){this.loading=!0;const t=await M(this.apiUrl+o);this.data=t.data,this.pagination=t.pagination,this.loading=!1},async GenerateInvoice(o){await x(o)}},watch:{filters_update(o){this.page=1,this.filters=o,this.getFetchData(o)},deletedRow(o){const t=this.data.findIndex(u=>u.id===parseInt(o));t!==-1&&this.data.splice(t,1)}}},i=o=>(q("data-v-102cc548"),o=o(),I(),o),z={key:0,class:"table-responsive"},T={class:"table table-bordered"},A={class:"bg-light"},O=i(()=>e("th",null,"Ref",-1)),E=i(()=>e("th",null,"Montant",-1)),H={key:0},J=i(()=>e("th",null,"Colis",-1)),K=i(()=>e("th",null,"Cloturé",-1)),Q=i(()=>e("th",null,"Versé",-1)),W=i(()=>e("th",null,"Action",-1)),X=i(()=>e("span",{class:"header_side"},"Ref : ",-1)),Y=["onClick"],Z=i(()=>e("span",{class:"header_side"},"Montant : ",-1)),$={key:0},ee=i(()=>e("span",{class:"header_side"},"Livreur : ",-1)),te=i(()=>e("span",{class:"header_side"},"Colis : ",-1)),se=i(()=>e("span",{class:"header_side"},"Cloturé : ",-1)),oe=i(()=>e("span",{class:"header_side"},"Versé : ",-1)),le={class:"table_actions"},ae={class:"d-flex align-items-center order-actions"},ne=["onClick"],ie=i(()=>e("i",{class:"fas fa-file-invoice"},null,-1)),re=[ie],de={key:0,type:"button",class:"btn bg-light btn-sm waves-effect mx-1"},ce=i(()=>e("i",{class:"fas fa-pencil-alt"},null,-1)),ue=[ce],_e=["onClick"],pe=i(()=>e("i",{class:"fas fa-trash-alt"},null,-1)),he=[pe],ge={class:"row d-flex justify-content-between align-items-center"},ve={class:"col-md-1"},fe=F('<option value="10" data-v-102cc548>10</option><option value="20" data-v-102cc548>20</option><option value="50" data-v-102cc548>50</option><option value="100" data-v-102cc548>100</option><option value="200" data-v-102cc548>200</option><option value="500" data-v-102cc548>500</option><option value="1000" data-v-102cc548>1000</option>',7),Ce=[fe],ke={class:"col-md-6 d-flex justify-content-end align-items-center"},be={class:"pagination d-flex align-items-end"},me={key:0,class:"page-item"},ye=["onClick"],Ve={key:1,class:"page-item"},we={key:1,class:"d-flex justify-content-center py-4 bg-light"},Re=i(()=>e("span",{class:"loader"},null,-1)),De=[Re],Me={key:2,class:"p-3 text-center bg-light"},xe=i(()=>e("p",null,"no-data",-1)),Se=[xe],Ue=i(()=>e("div",{class:"mx-2 m-3 pb-3 pt-3"},null,-1));function qe(o,t,u,g,l,d){const v=m("checkd"),V=m("Supprimer");return a(),r(f,null,[l.data.length>0?(a(),r("div",z,[e("table",T,[e("thead",A,[e("tr",null,[O,E,l.Role!="deliveryman"?(a(),r("th",H,"Livreur")):_("",!0),J,K,Q,W])]),e("tbody",null,[(a(!0),r(f,null,y(l.data,s=>(a(),r("tr",{key:s.id},[e("td",null,[X,p(),e("a",{onClick:n=>d.GenerateInvoice(s.id),href:"","data-bs-toggle":"modal"},c(s.Ref),9,Y)]),e("td",null,[Z,p(" "+c(s.Montant),1)]),l.Role!="deliveryman"?(a(),r("td",$,[ee,p(" "+c(s.Livreur),1)])):_("",!0),e("td",null,[te,p(" "+c(s.Colis),1)]),e("td",null,[se,d.checkModule(u.requiredModule_Cloturé)&&l.Role!="deliveryman"?(a(),C(v,{key:0,modelValue:l.close.Cloturé,"onUpdate:modelValue":t[0]||(t[0]=n=>l.close.Cloturé=n),value:l.close.Cloturé,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`cl-${s.Ref}`,is_checked:s.Cloturé,checked:s.Cloturé===1,"onUpdate:value":t[1]||(t[1]=n=>o.formData.Cloturé=n),onChange:n=>d.toggleCloture(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])):d.checkModule(u.requiredModule_Cloturé)&&!s.Cloturé?(a(),C(v,{key:1,modelValue:l.close.Cloturé,"onUpdate:modelValue":t[2]||(t[2]=n=>l.close.Cloturé=n),value:l.close.Cloturé,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`cl-${s.Ref}`,is_checked:s.Cloturé,checked:s.Cloturé===1,"onUpdate:value":t[3]||(t[3]=n=>o.formData.Cloturé=n),onChange:n=>d.toggleCloture(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])):(a(),r("div",{key:2,class:k(`badge ${s.Cloturé===1?"bg-success ":"bg-danger "}`)},c(s.Cloturé===1?"Oui":"Non"),3))]),e("td",null,[oe,d.checkModule(u.requiredModule_Versé)?(a(),C(v,{key:0,modelValue:l.paid.Versé,"onUpdate:modelValue":t[4]||(t[4]=n=>l.paid.Versé=n),value:l.paid.Versé,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`pd-${s.Ref}`,is_checked:s.Versé,checked:s.Versé===1,"onUpdate:value":t[5]||(t[5]=n=>o.formData.Versé=n),onChange:n=>d.togglepaid(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])):(a(),r("div",{key:1,class:k(`badge badge-success ${s.Versé===1?"bg-success ":"bg-danger "}`)},c(s.Versé===1?"Oui":"Non"),3))]),e("td",le,[e("div",ae,[e("button",{onClick:n=>d.GenerateInvoice(s.id),type:"button",class:"btn bg-light btn-sm waves-effect mx-1"},re,8,ne),l.Role!="deliveryman"?(a(),r("button",de,ue)):_("",!0),l.Role!="deliveryman"?(a(),r("button",{key:1,type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:n=>{l.delete_row_id=s.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},he,8,_e)):_("",!0)])])]))),128))])]),e("div",ge,[e("div",ve,[S(e("select",{class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>l.per_page=s),onChange:t[7]||(t[7]=(...s)=>d.pageCount&&d.pageCount(...s))},Ce,544),[[U,l.per_page]])]),e("nav",ke,[e("ul",be,[l.pagination.current_page>1?(a(),r("li",me,[e("a",{class:"page-link",href:"#",onClick:t[8]||(t[8]=s=>d.loadPage(l.pagination.current_page-1))},"Précédent")])):_("",!0),(a(!0),r(f,null,y(l.pagination.last_page,s=>(a(),r("li",{class:k(["page-item",{active:s===l.pagination.current_page}]),key:s},[e("a",{class:"page-link",href:"#",onClick:n=>d.loadPage(s)},c(s),9,ye)],2))),128)),l.pagination.current_page<l.pagination.last_page?(a(),r("li",Ve,[e("a",{class:"page-link",href:"#",onClick:t[9]||(t[9]=s=>d.loadPage(l.pagination.current_page+1))},"Suivant")])):_("",!0)])])])])):l.loading?(a(),r("div",we,De)):(a(),r("div",Me,Se)),h(V,{apiUrl:`https://api.gestion-livraison.pro/api/delivery/invoice/${l.delete_row_id}/delete`,onDeletedId:t[10]||(t[10]=s=>l.deletedRow=s)},null,8,["apiUrl"]),Ue],64)}const Ie=w(G,[["render",qe],["__scopeId","data-v-102cc548"]]),Fe={class:"main-content"},Pe={class:"page-content"},Le={class:"container-fluid"},Ne={class:"card"},Be={class:"card-body"},je={class:"mb-3"},Je={__name:"liste_of_invoices",setup(o){const t=P(null);return(u,g)=>(a(),r("div",Fe,[e("div",Pe,[e("div",Le,[h(B,{pageTitle:"Factures Livreurs"}),e("div",Ne,[e("div",Be,[e("div",je,[h(j,{placeholder:"Rechercher par Motcle",onFilterUpdated:g[0]||(g[0]=l=>t.value=l),filters_fields:"driver,search,date"})]),h(Ie,{apiUrl:"https://api.gestion-livraison.pro/api/delivery_invoices",requiredModule_Cloturé:"FactureLivreurCloturer",requiredModule_Versé:"FactureLivreurPaye",filters_update:t.value},null,8,["filters_update"])])])])])]))}};export{Je as default};
