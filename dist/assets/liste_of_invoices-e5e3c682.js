import{h as w}from"./heading-f00730b6.js";import{bB as R,bD as x,bI as k,bL as M,bJ as S,bS as D,aM as m,az as n,q as r,r as e,p as _,F as f,aK as y,y as p,a_ as d,o as C,aj as b,bu as U,bi as q,z as h,aD as I,aA as F,x as P,aH as N}from"./index-3afa6c13.js";import{c as B}from"./check-fe9a82f7.js";import{S as j}from"./delete-6aebbd9b.js";import{f as G}from"./search-e618f654.js";import"./select-ab6ad5d3.js";import"./defineProperty-b185edd1.js";const z={components:{checkd:B,Supprimer:j},props:{apiUrl:{type:String,required:!0},requiredModule_Cloturé:{type:String},requiredModule_Versé:{type:String},filters_update:{type:String,required:!0}},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,data:[],close:{Cloturé:""},paid:{Versé:""},Role:x(),delete_row_id:"",deletedRow:"",loading:!1}},mounted(){this.getFetchData("")},methods:{loadPage(o){this.page=o;let t;this.filters?t=this.filters+"&page="+this.page+"&per_page="+this.per_page:t="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(t)},pageCount(){let o;this.filters?o=this.filters+"&page="+this.page+"&per_page="+this.per_page:o="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(o),console.log(o)},async toggleCloture(o){o.Cloturé=o.Cloturé===1?0:1,await k(`https://api.gestion-livraison.pro/api/customer/invoice/${o.id}/close/update`,{Cloturé:o.Cloturé})},async togglepaid(o){o.Versé=o.Versé===1?0:1,await k(`https://api.gestion-livraison.pro/api/customer/invoice/${o.id}/paid/update`,{Versé:o.Versé})},checkModule(o){const t=M(o);return console.log(t),t},async getFetchData(o){this.loading=!0;const t=await S(this.apiUrl+o);this.data=t.data,this.pagination=t.pagination,this.loading=!1},async GenerateInvoice(o){await D(o)}},watch:{filters_update(o){this.page=1,this.filters=o,this.getFetchData(o)},deletedRow(o){const t=this.data.findIndex(u=>u.id===parseInt(o));t!==-1&&this.data.splice(t,1)}}},i=o=>(I("data-v-b06090e4"),o=o(),F(),o),A={key:0,class:"table-responsive"},L={class:"table table-bordered"},O={class:"bg-light"},T=i(()=>e("th",null,"Ref",-1)),E=i(()=>e("th",null,"Montant",-1)),H={key:0},J=i(()=>e("th",null,"Colis",-1)),K=i(()=>e("th",null,"Cloturé",-1)),Q=i(()=>e("th",null,"Versé",-1)),W=i(()=>e("th",null,"Action",-1)),X=i(()=>e("span",{class:"header_side"},"Ref : ",-1)),Y=["onClick"],Z=i(()=>e("span",{class:"header_side"},"Montant : ",-1)),$={key:0},ee=i(()=>e("span",{class:"header_side"},"Client : ",-1)),te=i(()=>e("span",{class:"header_side"},"Colis : ",-1)),se=i(()=>e("span",{class:"header_side"},"Cloturé : ",-1)),oe=i(()=>e("span",{class:"header_side"},"Versé : ",-1)),le={class:"table_actions"},ne={class:"d-flex align-items-center order-actions"},ae=["onClick"],ie=i(()=>e("i",{class:"fas fa-file-invoice"},null,-1)),re=[ie],ce={key:0,type:"button",class:"btn bg-light btn-sm waves-effect mx-1"},de=i(()=>e("i",{class:"fas fa-pencil-alt"},null,-1)),ue=[de],_e=["onClick"],pe=i(()=>e("i",{class:"fas fa-trash-alt"},null,-1)),he=[pe],ge={class:"row d-flex justify-content-between align-items-center"},ve={class:"col-md-1"},fe=P('<option value="10" data-v-b06090e4>10</option><option value="20" data-v-b06090e4>20</option><option value="50" data-v-b06090e4>50</option><option value="100" data-v-b06090e4>100</option><option value="200" data-v-b06090e4>200</option><option value="500" data-v-b06090e4>500</option><option value="1000" data-v-b06090e4>1000</option>',7),Ce=[fe],be={class:"col-md-6 d-flex justify-content-end align-items-center"},ke={class:"pagination d-flex align-items-end"},me={key:0,class:"page-item"},ye=["onClick"],Ve={key:1,class:"page-item"},we={key:1,class:"d-flex justify-content-center py-4 bg-light"},Re=i(()=>e("span",{class:"loader"},null,-1)),xe=[Re],Me={key:2,class:"p-3 text-center bg-light"},Se=i(()=>e("p",null,"no-data",-1)),De=[Se],Ue=i(()=>e("div",{class:"mx-2 m-3 pb-3 pt-3"},null,-1));function qe(o,t,u,g,l,c){const v=m("checkd"),V=m("Supprimer");return n(),r(f,null,[l.data.length>0?(n(),r("div",A,[e("table",L,[e("thead",O,[e("tr",null,[T,E,l.Role!="customer"?(n(),r("th",H,"Client")):_("",!0),J,K,Q,W])]),e("tbody",null,[(n(!0),r(f,null,y(l.data,s=>(n(),r("tr",{key:s.id},[e("td",null,[X,p(),e("a",{onClick:a=>c.GenerateInvoice(s.id),href:"","data-bs-toggle":"modal"},d(s.Ref),9,Y)]),e("td",null,[Z,p(" "+d(s.Montant),1)]),l.Role!="customer"?(n(),r("td",$,[ee,p(" "+d(s.Client),1)])):_("",!0),e("td",null,[te,p(" "+d(s.Colis),1)]),e("td",null,[se,c.checkModule(u.requiredModule_Cloturé)&&l.Role!="customer"?(n(),C(v,{key:0,modelValue:l.close.Cloturé,"onUpdate:modelValue":t[0]||(t[0]=a=>l.close.Cloturé=a),value:l.close.Cloturé,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`cl-${s.Ref}`,is_checked:s.Cloturé,checked:s.Cloturé===1,"onUpdate:value":t[1]||(t[1]=a=>o.formData.Cloturé=a),onChange:a=>c.toggleCloture(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])):c.checkModule(u.requiredModule_Cloturé)&&!s.Cloturé?(n(),C(v,{key:1,modelValue:l.close.Cloturé,"onUpdate:modelValue":t[2]||(t[2]=a=>l.close.Cloturé=a),value:l.close.Cloturé,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`cl-${s.Ref}`,is_checked:s.Cloturé,checked:s.Cloturé===1,"onUpdate:value":t[3]||(t[3]=a=>o.formData.Cloturé=a),onChange:a=>c.toggleCloture(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])):(n(),r("div",{key:2,class:b(`badge ${s.Cloturé===1?"bg-success ":"bg-danger "}`)},d(s.Cloturé===1?"Oui":"Non"),3))]),e("td",null,[oe,c.checkModule(u.requiredModule_Versé)?(n(),C(v,{key:0,modelValue:l.paid.Versé,"onUpdate:modelValue":t[4]||(t[4]=a=>l.paid.Versé=a),value:l.paid.Versé,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`pd-${s.Ref}`,is_checked:s.Versé,checked:s.Versé===1,"onUpdate:value":t[5]||(t[5]=a=>l.paid.Versé=a),onChange:a=>c.togglepaid(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])):(n(),r("div",{key:1,class:b(`badge badge-success ${s.Versé===1?"bg-success ":"bg-danger "}`)},d(s.Versé===1?"Oui":"Non"),3))]),e("td",le,[e("div",ne,[e("button",{onClick:a=>c.GenerateInvoice(s.id),type:"button",class:"btn bg-light btn-sm waves-effect mx-1"},re,8,ae),l.Role!="customer"?(n(),r("button",ce,ue)):_("",!0),l.Role!="customer"?(n(),r("button",{key:1,type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:a=>{l.delete_row_id=s.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},he,8,_e)):_("",!0)])])]))),128))])]),e("div",ge,[e("div",ve,[U(e("select",{class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>l.per_page=s),onChange:t[7]||(t[7]=(...s)=>c.pageCount&&c.pageCount(...s))},Ce,544),[[q,l.per_page]])]),e("nav",be,[e("ul",ke,[l.pagination.current_page>1?(n(),r("li",me,[e("a",{class:"page-link",href:"#",onClick:t[8]||(t[8]=s=>c.loadPage(l.pagination.current_page-1))},"Précédent")])):_("",!0),(n(!0),r(f,null,y(l.pagination.last_page,s=>(n(),r("li",{class:b(["page-item",{active:s===l.pagination.current_page}]),key:s},[e("a",{class:"page-link",href:"#",onClick:a=>c.loadPage(s)},d(s),9,ye)],2))),128)),l.pagination.current_page<l.pagination.last_page?(n(),r("li",Ve,[e("a",{class:"page-link",href:"#",onClick:t[9]||(t[9]=s=>c.loadPage(l.pagination.current_page+1))},"Suivant")])):_("",!0)])])])])):l.loading?(n(),r("div",we,xe)):(n(),r("div",Me,De)),h(V,{apiUrl:`https://api.gestion-livraison.pro/api/customer/invoice/${l.delete_row_id}/delete`,onDeletedId:t[10]||(t[10]=s=>l.deletedRow=s)},null,8,["apiUrl"]),Ue],64)}const Ie=R(z,[["render",qe],["__scopeId","data-v-b06090e4"]]),Fe={class:"main-content"},Pe={class:"page-content"},Ne={class:"container-fluid"},Be={class:"card"},je={class:"card-body"},Ge={class:"mb-3"},Je={__name:"liste_of_invoices",setup(o){const t=N(null);return(u,g)=>(n(),r("div",Fe,[e("div",Pe,[e("div",Ne,[h(w,{pageTitle:"Factures Clients"}),e("div",Be,[e("div",je,[e("div",Ge,[h(G,{placeholder:"Rechercher par Motcle",onFilterUpdated:g[0]||(g[0]=l=>t.value=l),filters_fields:"customer,search,date"})]),h(Ie,{apiUrl:"https://api.gestion-livraison.pro/api/customer_invoices",requiredModule_Cloturé:"FactureClientCloturer",requiredModule_Versé:"FactureClientPaye",filters_update:t.value},null,8,["filters_update"])])])])])]))}};export{Je as default};
