import{bB as k,bI as y,bJ as C,aM as h,az as o,q as n,r as a,F as p,aK as g,a_ as u,p as _,y as A,z as v,bs as w,bu as S,bi as x,aj as F,aD as D,aA as I,x as V}from"./index-3afa6c13.js";import{c as q}from"./check-fe9a82f7.js";import{S as U}from"./delete-6aebbd9b.js";const j={components:{checkd:q,Supprimer:U},props:{apiUrl:{type:String,required:!0},Module:{type:String,required:!0},ActiveCol:{type:String,required:!0},filters_update:{type:String,required:!0},hidden_columns:{type:Object,required:!0}},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,data:[],tableFields:[],delete_row_id:"",deletedRow:"",loading:!1}},methods:{async toggleActive(t){t.Active=t.Active===1?0:1,await y(`https://api.gestion-livraison.pro/api/user/${t.user_id}/activation`,{Active:t.Active})},async getFetchData(t=null){this.loading=!0;const e=await C(this.apiUrl+t);console.log(e),this.data=e.data,this.data.length>0&&(this.pagination=e.pagination,this.tableFields=Object.keys(e.data[0]),this.tableFields=this.tableFields.filter(c=>!this.hidden_columns.includes(c))),this.loading=!1},loadPage(t){this.page=t;let e;this.filters?e=this.filters+"&page="+this.page+"&per_page="+this.per_page:e="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(e)},pageCount(t){console.log(t);let e;this.filters?e=this.filters+"&page="+this.page+"&per_page="+this.per_page:e="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(e),console.log(e)}},mounted(){this.getFetchData("")},watch:{filters_update(t){this.page=1,this.filters=t,this.getFetchData(t)},deletedRow(t){const e=this.data.findIndex(c=>c.id===parseInt(t));e!==-1&&this.data.splice(e,1)}}},d=t=>(D("data-v-978f28c8"),t=t(),I(),t),P={key:0,class:"table-responsive"},M={class:"table table-bordered"},N={class:"bg-light"},R={key:0},B=d(()=>a("th",null,"Action",-1)),z={class:"header_side"},O={key:0},E=d(()=>a("span",{class:"header_side"},"Active : ",-1)),J={key:1,class:"table_actions"},K={class:"d-flex align-items-center order-actions"},L=d(()=>a("i",{class:"fas fa-pencil-alt"},null,-1)),T=["onClick"],G=d(()=>a("i",{class:"fas fa-trash-alt"},null,-1)),H=[G],Q={class:"row d-flex justify-content-between align-items-center"},W={class:"col-md-1"},X=V('<option value="10" data-v-978f28c8>10</option><option value="20" data-v-978f28c8>20</option><option value="50" data-v-978f28c8>50</option><option value="100" data-v-978f28c8>100</option><option value="200" data-v-978f28c8>200</option><option value="500" data-v-978f28c8>500</option><option value="1000" data-v-978f28c8>1000</option>',7),Y=[X],Z={class:"col-md-6 d-flex justify-content-end align-items-center"},$={class:"pagination d-flex align-items-end"},ee={key:0,class:"page-item"},te=["onClick"],se={key:1,class:"page-item"},ae={key:1,class:"d-flex justify-content-center py-4 bg-light"},ie=d(()=>a("span",{class:"loader"},null,-1)),oe=[ie],ne={key:2,class:"p-3 text-center bg-light"},le=d(()=>a("p",null,"no-data",-1)),ce=[le],de=d(()=>a("div",{class:"mx-2 m-3 pb-3 pt-3"},null,-1));function re(t,e,c,pe,i,r){const f=h("checkd"),m=h("router-link"),b=h("Supprimer");return o(),n(p,null,[i.data.length>0?(o(),n("div",P,[a("table",M,[a("thead",N,[a("tr",null,[(o(!0),n(p,null,g(i.tableFields,s=>(o(),n("th",{key:s},u(s),1))),128)),c.ActiveCol?(o(),n("th",R,"Active")):_("",!0),B])]),a("tbody",null,[(o(!0),n(p,null,g(i.data,s=>(o(),n("tr",{key:s.id},[(o(!0),n(p,null,g(i.tableFields,l=>(o(),n("td",{key:l},[a("span",z,u(l)+" : ",1),A(" "+u(s[l]),1)]))),128)),c.ActiveCol?(o(),n("td",O,[E,v(f,{modelValue:t.IsActive,"onUpdate:modelValue":e[0]||(e[0]=l=>t.IsActive=l),value:t.IsActive,Class_Content:"col-md-1 mb-1 mb-sm-0",id_check:`User-${s.user_id}`,is_checked:s.Active,checked:s.Active===1,"onUpdate:value":e[1]||(e[1]=l=>t.IsActive=l),onChange:l=>r.toggleActive(s)},null,8,["modelValue","value","id_check","is_checked","checked","onChange"])])):_("",!0),t.Role!="deliveryman"?(o(),n("td",J,[a("div",K,[v(m,{to:`/${c.Module}/${s.id}/update`,class:"btn bg-light btn-sm waves-effect mx-1"},{default:w(()=>[L]),_:2},1032,["to"]),a("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:l=>{i.delete_row_id=s.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},H,8,T)])])):_("",!0)]))),128))])]),a("div",Q,[a("div",W,[S(a("select",{class:"form-control","onUpdate:modelValue":e[2]||(e[2]=s=>i.per_page=s),onChange:e[3]||(e[3]=(...s)=>r.pageCount&&r.pageCount(...s))},Y,544),[[x,i.per_page]])]),a("nav",Z,[a("ul",$,[i.pagination.current_page>1?(o(),n("li",ee,[a("a",{class:"page-link",href:"#",onClick:e[4]||(e[4]=s=>r.loadPage(i.pagination.current_page-1))},"Précédent")])):_("",!0),(o(!0),n(p,null,g(i.pagination.last_page,s=>(o(),n("li",{class:F(["page-item",{active:s===i.pagination.current_page}]),key:s},[a("a",{class:"page-link",href:"#",onClick:l=>r.loadPage(s)},u(s),9,te)],2))),128)),i.pagination.current_page<i.pagination.last_page?(o(),n("li",se,[a("a",{class:"page-link",href:"#",onClick:e[5]||(e[5]=s=>r.loadPage(i.pagination.current_page+1))},"Suivant")])):_("",!0)])])])])):i.loading?(o(),n("div",ae,oe)):(o(),n("div",ne,ce)),v(b,{apiUrl:`https://api.gestion-livraison.pro/api/${c.Module}/${i.delete_row_id}/delete`,onDeletedId:e[6]||(e[6]=s=>i.deletedRow=s)},null,8,["apiUrl"]),de],64)}const he=k(j,[["render",re],["__scopeId","data-v-978f28c8"]]);export{he as t};
