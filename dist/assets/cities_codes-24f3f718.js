import{b as w}from"./heading_modal-8cb43ed1.js";import{bB as C,bI as D,bG as x,bJ as k,aM as b,az as i,q as l,r as t,F as _,aK as u,a_ as h,y as F,bu as N,bi as U,p as f,aj as S,bx as v,z as c,aD as V,aA as I,x as A,aH as M}from"./index-3afa6c13.js";import{i as j}from"./input-e668dea8.js";import{b as P}from"./simple-2283d124.js";import{S as R}from"./select-ab6ad5d3.js";import{S as q}from"./delete-6aebbd9b.js";import{f as B}from"./search-e618f654.js";import"./defineProperty-b185edd1.js";const z={emits:["data-updated"],components:{input_text:j,button_simple:P,SelectDropdown:R,Supprimer:q},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,formData:{Nom:"",id:""},isEditMode:!1,data:[],tableFields:[],module:[],delete_row_id:"",deletedRow:"",loading:!1}},props:{apiUrl:{type:String,required:!0},filters_update:{type:String,required:!0}},methods:{loadPage(s){this.page=s;let e;this.filters?e=this.filters+"&page="+this.page+"&per_page="+this.per_page:e="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(e)},pageCount(){let s;this.filters?s=this.filters+"&page="+this.page+"&per_page="+this.per_page:s="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(s),console.log(s)},async submitFormUpdate(){const s=this.formData.id,e=await D(`https://api.gestion-livraison.pro/api/city/code/${s}/update`,this.formData);this.formData={id:"",Nom:""},$("#modalUpdate").modal("hide");const r=this.data.findIndex(m=>m.id===e.data.id);r!==-1&&(this.data[r]={...this.data[r],...e.data})},async submitFormAdd(){const s=await x("https://api.gestion-livraison.pro/api/city/code/new",this.formData);this.formData={Nom:""},$("#modalAdd").modal("hide"),this.data.push(s.data)},openUpdateModal(s){this.formData={...s},$("#modalUpdate").modal("show")},async getFetchData(s=null){this.loading=!0;let e=await k(this.apiUrl+s);this.data=e.data,this.pagination=e.pagination,this.data.length>0&&(this.tableFields=Object.keys(e.data[0])),this.loading=!1}},mounted(){this.getFetchData("")},watch:{filters_update(s){this.page=1,this.filters=s,this.getFetchData(s)},deletedRow(s){const e=this.data.findIndex(r=>r.id===parseInt(s));e!==-1&&this.data.splice(e,1)}}},n=s=>(V("data-v-2e4b375f"),s=s(),I(),s),L={key:0,class:"table-responsive"},T={class:"table table-bordered"},E={class:"bg-light"},G=n(()=>t("th",null,"Action",-1)),H={class:"header_side"},J={class:"table_actions"},K={class:"d-flex align-items-center order-actions"},O=["onClick"],Q=n(()=>t("i",{class:"fas fa-pencil-alt"},null,-1)),W=[Q],X=["onClick"],Y=n(()=>t("i",{class:"fas fa-trash-alt"},null,-1)),Z=[Y],tt={class:"row d-flex justify-content-between align-items-center"},et={class:"col-md-1"},at=A('<option value="10" data-v-2e4b375f>10</option><option value="20" data-v-2e4b375f>20</option><option value="50" data-v-2e4b375f>50</option><option value="100" data-v-2e4b375f>100</option><option value="200" data-v-2e4b375f>200</option><option value="500" data-v-2e4b375f>500</option><option value="1000" data-v-2e4b375f>1000</option>',7),st=[at],ot={class:"col-md-6 d-flex justify-content-end align-items-center"},it={class:"pagination d-flex align-items-end"},lt={key:0,class:"page-item"},dt=["onClick"],nt={key:1,class:"page-item"},rt={key:1,class:"d-flex justify-content-center py-4 bg-light"},pt=n(()=>t("span",{class:"loader"},null,-1)),ct=[pt],mt={key:2,class:"p-3 text-center bg-light"},_t=n(()=>t("p",null,"no-data",-1)),ut=[_t],ht={id:"modalUpdate",class:"modal fade",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},gt={class:"modal-dialog"},bt={class:"modal-content"},ft=n(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title mt-0",id:"myModalLabel"},"ID"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),vt={class:"modal-body"},yt=n(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),t("button",{type:"submit",class:"btn btn-primary waves-effect waves-light"},"Modifier")],-1)),wt={id:"modalAdd",class:"modal fade",tabindex:"-1","aria-labelledby":"modalAdd","aria-hidden":"true"},Ct={class:"modal-dialog"},Dt={class:"modal-content"},xt=n(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title mt-0",id:"modalAdd"},"Nouvelle Code"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),kt={class:"modal-body"},Ft=n(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),t("button",{type:"submit",class:"btn btn-primary waves-effect waves-light"},"Ajouter")],-1));function Nt(s,e,r,m,o,d){const g=b("input_text"),y=b("Supprimer");return i(),l(_,null,[o.data.length>0?(i(),l("div",L,[t("table",T,[t("thead",E,[t("tr",null,[(i(!0),l(_,null,u(o.tableFields,a=>(i(),l("th",{key:a},h(a),1))),128)),G])]),t("tbody",null,[(i(!0),l(_,null,u(o.data,a=>(i(),l("tr",{key:a.id},[(i(!0),l(_,null,u(o.tableFields,p=>(i(),l("td",{key:p},[t("span",H,h(p)+" : ",1),F(" "+h(a[p]),1)]))),128)),t("td",J,[t("div",K,[t("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:p=>d.openUpdateModal(a)},W,8,O),t("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:p=>{o.delete_row_id=a.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},Z,8,X)])])]))),128))])]),t("div",tt,[t("div",et,[N(t("select",{class:"form-control","onUpdate:modelValue":e[0]||(e[0]=a=>o.per_page=a),onChange:e[1]||(e[1]=(...a)=>d.pageCount&&d.pageCount(...a))},st,544),[[U,o.per_page]])]),t("nav",ot,[t("ul",it,[o.pagination.current_page>1?(i(),l("li",lt,[t("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=a=>d.loadPage(o.pagination.current_page-1))},"Précédent")])):f("",!0),(i(!0),l(_,null,u(o.pagination.last_page,a=>(i(),l("li",{class:S(["page-item",{active:a===o.pagination.current_page}]),key:a},[t("a",{class:"page-link",href:"#",onClick:p=>d.loadPage(a)},h(a),9,dt)],2))),128)),o.pagination.current_page<o.pagination.last_page?(i(),l("li",nt,[t("a",{class:"page-link",href:"#",onClick:e[3]||(e[3]=a=>d.loadPage(o.pagination.current_page+1))},"Suivant")])):f("",!0)])])])])):o.loading?(i(),l("div",rt,ct)):(i(),l("div",mt,ut)),t("div",ht,[t("form",{onSubmit:e[6]||(e[6]=v((...a)=>d.submitFormUpdate&&d.submitFormUpdate(...a),["prevent"]))},[t("div",gt,[t("div",bt,[ft,t("div",vt,[c(g,{modelValue:s.Nom,"onUpdate:modelValue":e[4]||(e[4]=a=>s.Nom=a),label:"Nom",type:"text",Class_Content:"col-md-12 mt-4",value:o.formData.Nom,"onUpdate:value":e[5]||(e[5]=a=>o.formData.Nom=a)},null,8,["modelValue","value"])]),yt])])],32)]),t("div",wt,[t("form",{onSubmit:e[9]||(e[9]=v((...a)=>d.submitFormAdd&&d.submitFormAdd(...a),["prevent"]))},[t("div",Ct,[t("div",Dt,[xt,t("div",kt,[c(g,{modelValue:s.Nom,"onUpdate:modelValue":e[7]||(e[7]=a=>s.Nom=a),label:"Nom",type:"text",Class_Content:"col-md-12 mt-4",value:o.formData.Nom,"onUpdate:value":e[8]||(e[8]=a=>o.formData.Nom=a)},null,8,["modelValue","value"])]),Ft])])],32)]),c(y,{apiUrl:`https://api.gestion-livraison.pro/api/city/code/${o.delete_row_id}/delete`,onDeletedId:e[10]||(e[10]=a=>o.deletedRow=a)},null,8,["apiUrl"])],64)}const Ut=C(z,[["render",Nt],["__scopeId","data-v-2e4b375f"]]),St={class:"main-content"},Vt={class:"page-content"},It={class:"container-fluid"},At={class:"card"},Mt={class:"card-body"},jt={class:"mb-3"},Gt={__name:"cities_codes",setup(s){const e=M(null);return(r,m)=>(i(),l("div",St,[t("div",Vt,[t("div",It,[c(w,{pageTitle:"Villes Codes",toggle:"modal",target:"#modalAdd",modalText:"Nouvelle Code"}),t("div",At,[t("div",Mt,[t("div",jt,[c(B,{placeholder:"Rechercher par Motcle",onFilterUpdated:m[0]||(m[0]=o=>e.value=o),filters_fields:"search"})]),c(Ut,{apiUrl:"https://api.gestion-livraison.pro/api/cities/codes",filters_update:e.value},null,8,["filters_update"])])])])])]))}};export{Gt as default};
