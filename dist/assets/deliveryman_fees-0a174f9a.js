import{b as C}from"./heading_modal-8cb43ed1.js";import{bB as w,bI as U,bG as V,bJ as I,aM as g,az as o,q as l,r as t,F as c,aK as f,a_ as h,y as F,p as b,bu as L,bi as k,aj as x,bx as y,z as n,aD as S,aA as R,x as N,aH as A}from"./index-3afa6c13.js";import{i as M}from"./input-e668dea8.js";import{b as j}from"./simple-2283d124.js";import{S as T}from"./select-ab6ad5d3.js";import{S as q}from"./delete-6aebbd9b.js";import{f as P}from"./search-e618f654.js";import"./defineProperty-b185edd1.js";const B={emits:["data-updated"],components:{input_text:M,button_simple:j,SelectDropdown:T,Supprimer:q},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,formData:{id:"",LivreurId:"",VilleId:"",Livre:"",Refuse:""},isEditMode:!1,data:[],tableFields:[],module:[],delete_row_id:"",deletedRow:"",loading:!1}},props:{apiUrl:{type:String,required:!0},filters_update:{type:String,required:!0},hidden_columns:{type:Object,required:!0}},methods:{loadPage(i){this.page=i;let e;this.filters?e=this.filters+"&page="+this.page+"&per_page="+this.per_page:e="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(e)},pageCount(){let i;this.filters?i=this.filters+"&page="+this.page+"&per_page="+this.per_page:i="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(i),console.log(i)},async submitFormUpdate(){const i=this.formData.id,e=await U(`https://api.gestion-livraison.pro/api/deliveryman/fees/${i}/update`,this.formData);this.formData={id:"",LivreurId:"",VilleId:"",Livre:"",Refuse:""},$("#modalUpdate").modal("hide");const r=this.data.findIndex(m=>m.id===e.data.id);r!==-1&&(this.data[r]={...this.data[r],...e.data})},async submitFormAdd(){const i=await V("https://api.gestion-livraison.pro/api/deliveryman/fees/new",this.formData);this.formData={id:"",LivreurId:"",VilleId:"",Livre:"",Refuse:""},$("#modalAdd").modal("hide"),this.data.push(i.data)},openUpdateModal(i){this.formData={...i},$("#modalUpdate").modal("show")},async getFetchData(i=null){this.loading=!0;const e=await I(this.apiUrl+i);this.data=e.data,this.pagination=e.pagination,this.data.length>0&&(this.tableFields=Object.keys(e.data[0]),this.tableFields=this.tableFields.filter(r=>!this.hidden_columns.includes(r))),this.loading=!1}},mounted(){this.getFetchData("")},watch:{filters_update(i){this.page=1,this.filters=i,this.getFetchData(i)},deletedRow(i){const e=this.data.findIndex(r=>r.id===parseInt(i));e!==-1&&this.data.splice(e,1)}}},u=i=>(S("data-v-95e72977"),i=i(),R(),i),z={key:0,class:"table-responsive"},E={class:"table table-bordered"},H={class:"bg-light"},O=u(()=>t("th",null,"Action",-1)),G={class:"header_side"},J={key:0},K={class:"table_actions"},Q={class:"d-flex align-items-center order-actions"},W=["onClick"],X=u(()=>t("i",{class:"fas fa-pencil-alt"},null,-1)),Y=[X],Z=["onClick"],ee=u(()=>t("i",{class:"fas fa-trash-alt"},null,-1)),te=[ee],ae={class:"row d-flex justify-content-between align-items-center"},se={class:"col-md-1"},ie=N('<option value="10" data-v-95e72977>10</option><option value="20" data-v-95e72977>20</option><option value="50" data-v-95e72977>50</option><option value="100" data-v-95e72977>100</option><option value="200" data-v-95e72977>200</option><option value="500" data-v-95e72977>500</option><option value="1000" data-v-95e72977>1000</option>',7),oe=[ie],le={class:"col-md-6 d-flex justify-content-end align-items-center"},ne={class:"pagination d-flex align-items-end"},de={key:0,class:"page-item"},re=["onClick"],pe={key:1,class:"page-item"},ue={key:1,class:"d-flex justify-content-center py-4 bg-light"},me=u(()=>t("span",{class:"loader"},null,-1)),ce=[me],_e={key:2,class:"p-3 text-center bg-light"},ve=u(()=>t("p",null,"no-data",-1)),fe=[ve],he={id:"modalUpdate",class:"modal fade",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},ge={class:"modal-dialog"},be={class:"modal-content"},ye=u(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title mt-0",id:"myModalLabel"},"Modifier Tarif"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),De={class:"modal-body"},Ce={class:"row"},we=u(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),t("button",{type:"submit",class:"btn btn-primary waves-effect waves-light"},"Modifier")],-1)),Ue={id:"modalAdd",class:"modal fade",tabindex:"-1","aria-labelledby":"modalAdd","aria-hidden":"true"},Ve={class:"modal-dialog"},Ie={class:"modal-content"},Fe=u(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title mt-0",id:"modalAdd"},"Nouvelle Tarif"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Le={class:"modal-body"},ke={class:"row"},xe=u(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),t("button",{type:"submit",class:"btn btn-primary waves-effect waves-light"},"Ajouter")],-1));function Se(i,e,r,m,s,d){const _=g("SelectDropdown"),v=g("input_text"),D=g("Supprimer");return o(),l(c,null,[s.data.length>0?(o(),l("div",z,[t("table",E,[t("thead",H,[t("tr",null,[(o(!0),l(c,null,f(s.tableFields,a=>(o(),l("th",{key:a},h(a),1))),128)),O])]),t("tbody",null,[(o(!0),l(c,null,f(s.data,a=>(o(),l("tr",{key:a.id},[(o(!0),l(c,null,f(s.tableFields,p=>(o(),l("td",{key:p},[t("span",G,h(p)+" : ",1),F(" "+h(a[p])+" ",1),p==="Livre"||p==="Retourne"||p==="Refuse"?(o(),l("span",J," DH")):b("",!0)]))),128)),t("td",K,[t("div",Q,[t("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:p=>d.openUpdateModal(a)},Y,8,W),t("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:p=>{s.delete_row_id=a.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},te,8,Z)])])]))),128))])]),t("div",ae,[t("div",se,[L(t("select",{class:"form-control","onUpdate:modelValue":e[0]||(e[0]=a=>s.per_page=a),onChange:e[1]||(e[1]=(...a)=>d.pageCount&&d.pageCount(...a))},oe,544),[[k,s.per_page]])]),t("nav",le,[t("ul",ne,[s.pagination.current_page>1?(o(),l("li",de,[t("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=a=>d.loadPage(s.pagination.current_page-1))},"Précédent")])):b("",!0),(o(!0),l(c,null,f(s.pagination.last_page,a=>(o(),l("li",{class:x(["page-item",{active:a===s.pagination.current_page}]),key:a},[t("a",{class:"page-link",href:"#",onClick:p=>d.loadPage(a)},h(a),9,re)],2))),128)),s.pagination.current_page<s.pagination.last_page?(o(),l("li",pe,[t("a",{class:"page-link",href:"#",onClick:e[3]||(e[3]=a=>d.loadPage(s.pagination.current_page+1))},"Suivant")])):b("",!0)])])])])):s.loading?(o(),l("div",ue,ce)):(o(),l("div",_e,fe)),t("div",he,[t("form",{onSubmit:e[10]||(e[10]=y((...a)=>d.submitFormUpdate&&d.submitFormUpdate(...a),["prevent"]))},[t("div",ge,[t("div",be,[ye,t("div",De,[n(_,{value:s.formData.VilleId,apiUrl:"https://api.gestion-livraison.pro/api/cities",fieldName:"Nom",first_option:"Selectionner une Ville",label:"Ville",Class_Content:"col-md-12 mt-4","onUpdate:value":e[4]||(e[4]=a=>s.formData.VilleId=a)},null,8,["value"]),n(_,{value:s.formData.LivreurId,apiUrl:"https://api.gestion-livraison.pro/api/deliverymans",fieldName:"Nom",first_option:"Selectionner un Client",label:"Livreurs",Class_Content:"col-md-12 mt-4","onUpdate:value":e[5]||(e[5]=a=>s.formData.LivreurId=a)},null,8,["value"]),t("div",Ce,[n(v,{modelValue:i.Livre,"onUpdate:modelValue":e[6]||(e[6]=a=>i.Livre=a),label:"Frais livré",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Livre,"onUpdate:value":e[7]||(e[7]=a=>s.formData.Livre=a)},null,8,["modelValue","value"]),n(v,{modelValue:i.Refuse,"onUpdate:modelValue":e[8]||(e[8]=a=>i.Refuse=a),label:"Frais refusé",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Refuse,"onUpdate:value":e[9]||(e[9]=a=>s.formData.Refuse=a)},null,8,["modelValue","value"])])]),we])])],32)]),t("div",Ue,[t("form",{onSubmit:e[17]||(e[17]=y((...a)=>d.submitFormAdd&&d.submitFormAdd(...a),["prevent"]))},[t("div",Ve,[t("div",Ie,[Fe,t("div",Le,[n(_,{value:s.formData.VilleId,apiUrl:"https://api.gestion-livraison.pro/api/cities",fieldName:"Nom",first_option:"Selectionner une Ville",label:"Ville",Class_Content:"col-md-12 mt-4","onUpdate:value":e[11]||(e[11]=a=>s.formData.VilleId=a)},null,8,["value"]),n(_,{value:s.formData.LivreurId,apiUrl:"https://api.gestion-livraison.pro/api/deliverymans",fieldName:"Nom",first_option:"Selectionner un Client",label:"Livreurs",Class_Content:"col-md-12 mt-4","onUpdate:value":e[12]||(e[12]=a=>s.formData.LivreurId=a)},null,8,["value"]),t("div",ke,[n(v,{modelValue:i.Livre,"onUpdate:modelValue":e[13]||(e[13]=a=>i.Livre=a),label:"Frais livré",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Livre,"onUpdate:value":e[14]||(e[14]=a=>s.formData.Livre=a)},null,8,["modelValue","value"]),n(v,{modelValue:i.Refuse,"onUpdate:modelValue":e[15]||(e[15]=a=>i.Refuse=a),label:"Frais refusé",type:"text",Class_Content:"col-md-6 mt-4",value:s.formData.Refuse,"onUpdate:value":e[16]||(e[16]=a=>s.formData.Refuse=a)},null,8,["modelValue","value"])])]),xe])])],32)]),n(D,{apiUrl:`https://api.gestion-livraison.pro/api/deliveryman/fees/${s.delete_row_id}/delete`,onDeletedId:e[18]||(e[18]=a=>s.deletedRow=a)},null,8,["apiUrl"])],64)}const Re=w(B,[["render",Se],["__scopeId","data-v-95e72977"]]),Ne={class:"main-content"},Ae={class:"page-content"},Me={class:"container-fluid"},je={class:"card"},Te={class:"card-body"},qe={class:"mb-3"},Ke={__name:"deliveryman_fees",setup(i){const e=A(null);return(r,m)=>(o(),l("div",Ne,[t("div",Ae,[t("div",Me,[n(C,{pageTitle:"Livreurs Tarifs",toggle:"modal",target:"#modalAdd",modalText:"Nouveau Tarif"}),t("div",je,[t("div",Te,[t("div",qe,[n(P,{placeholder:"Rechercher par Motcle",onFilterUpdated:m[0]||(m[0]=s=>e.value=s),filters_fields:"driver,city"})]),n(Re,{apiUrl:"https://api.gestion-livraison.pro/api/deliverymans/fees",filters_update:e.value,hidden_columns:["VilleId","LivreurId","id"]},null,8,["filters_update"])])])])])]))}};export{Ke as default};
