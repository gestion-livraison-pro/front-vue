import{b as C}from"./heading_modal-8cb43ed1.js";import{bB as w,bI as U,bG as P,bJ as S,aM as f,az as l,q as i,r as e,F as c,aK as _,a_ as g,y as I,bu as V,bi as k,p as v,aj as F,bx as y,z as r,aD as N,aA as x,x as M,aH as A}from"./index-3afa6c13.js";import{i as j}from"./input-e668dea8.js";import{b as q}from"./simple-2283d124.js";import{S as R}from"./select-ab6ad5d3.js";import{S as B}from"./delete-6aebbd9b.js";import{f as L}from"./search-e618f654.js";import"./defineProperty-b185edd1.js";const z={components:{input_text:j,button_simple:q,SelectDropdown:R,Supprimer:B},data(){return{pagination:[],filters:"",pagination_filters:"",per_page:10,page:1,formData:{Phase:"",PhaseId:"",Nom:"",Coleur:""},isEditMode:!1,data:[],tableFields:[],module:[],delete_row_id:"",deletedRow:"",loading:!1}},props:{apiUrl:{type:String,required:!0},Module:{type:String,required:!0},filters_update:{type:String,required:!0},hidden_columns:{type:Object,required:!0}},methods:{loadPage(s){this.page=s;let t;this.filters?t=this.filters+"&page="+this.page+"&per_page="+this.per_page:t="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(t)},pageCount(){let s;this.filters?s=this.filters+"&page="+this.page+"&per_page="+this.per_page:s="?page="+this.page+"&per_page="+this.per_page,this.getFetchData(s),console.log(s)},async submitFormUpdate(){const s=this.formData.id,t=await U(`https://api.gestion-livraison.pro/api/order/status/${s}/update`,this.formData);this.formData.Phase="",this.formData.PhaseId="",this.formData.Coleur="",this.formData.id="";const n=this.data.findIndex(m=>m.id===t.data.id);console.log(n),n!==-1&&(this.data[n]={...this.data[n],...t.data},console.log(t.data))},openUpdateModal(s){console.log(s),this.formData={...s},$("#modalUpdate").modal("show")},async submitFormAdd(){const s=await P("https://api.gestion-livraison.pro/api/order/status/new",this.formData);this.formData.Phase="",this.formData.PhaseId="",this.formData.Coleur="",this.formData.id="",console.log(s.data),s.data&&this.data.push(s.data)},async getFetchData(s=null){this.loading=!0;const t=await S(this.apiUrl+s);this.data=t.data,this.pagination=t.pagination,this.data.length>0&&(this.tableFields=Object.keys(t.data[0]),this.tableFields=this.tableFields.filter(n=>!this.hidden_columns.includes(n))),this.loading=!1}},mounted(){this.getFetchData("")},watch:{filters_update(s){this.page=1,this.filters=s,this.getFetchData(s)},deletedRow(s){const t=this.data.findIndex(n=>n.id===parseInt(s));t!==-1&&this.data.splice(t,1)}}},p=s=>(N("data-v-70149713"),s=s(),x(),s),O={key:0,class:"table-responsive"},T={class:"table table-bordered"},E={class:"bg-light"},G=p(()=>e("th",null,"Action",-1)),H={class:"header_side"},J={class:"table_actions"},K={class:"d-flex align-items-center order-actions"},Q=["onClick"],W=p(()=>e("i",{class:"fas fa-pencil-alt"},null,-1)),X=[W],Y=["onClick"],Z=p(()=>e("i",{class:"fas fa-trash-alt"},null,-1)),tt=[Z],et={class:"row d-flex justify-content-between align-items-center"},at={class:"col-md-1"},st=M('<option value="10" data-v-70149713>10</option><option value="20" data-v-70149713>20</option><option value="50" data-v-70149713>50</option><option value="100" data-v-70149713>100</option><option value="200" data-v-70149713>200</option><option value="500" data-v-70149713>500</option><option value="1000" data-v-70149713>1000</option>',7),ot=[st],lt={class:"col-md-6 d-flex justify-content-end align-items-center"},it={class:"pagination d-flex align-items-end"},nt={key:0,class:"page-item"},dt=["onClick"],rt={key:1,class:"page-item"},pt={key:1,class:"d-flex justify-content-center py-4 bg-light"},ut=p(()=>e("span",{class:"loader"},null,-1)),mt=[ut],ct={key:2,class:"p-3 text-center bg-light"},ht=p(()=>e("p",null,"no-data",-1)),_t=[ht],gt={id:"modalUpdate",class:"modal fade",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},ft={class:"modal-dialog"},bt={class:"modal-content"},vt=p(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title mt-0",id:"myModalLabel"},"ID"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),yt={class:"modal-body"},Dt=p(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),e("button",{type:"submit",class:"btn btn-primary waves-effect waves-light","data-bs-dismiss":"modal"},"Modifier")],-1)),Ct={id:"modalAdd",class:"modal fade",tabindex:"-1","aria-labelledby":"modalAdd","aria-hidden":"true"},wt={class:"modal-dialog"},Ut={class:"modal-content"},Pt=p(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title mt-0",id:"modalAdd"},"ID"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),St={class:"modal-body"},It=p(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary waves-effect waves-light","data-bs-dismiss":"modal"},"Fermer"),e("button",{type:"submit",class:"btn btn-primary waves-effect waves-light","data-bs-dismiss":"modal"},"Ajouter")],-1));function Vt(s,t,n,m,o,d){const b=f("SelectDropdown"),h=f("input_text"),D=f("Supprimer");return l(),i(c,null,[o.data.length>0?(l(),i("div",O,[e("table",T,[e("thead",E,[e("tr",null,[(l(!0),i(c,null,_(o.tableFields,a=>(l(),i("th",{key:a},g(a),1))),128)),G])]),e("tbody",null,[(l(!0),i(c,null,_(o.data,a=>(l(),i("tr",{key:a.id},[(l(!0),i(c,null,_(o.tableFields,u=>(l(),i("td",{key:u},[e("span",H,g(u)+" : ",1),I(" "+g(a[u]),1)]))),128)),e("td",J,[e("div",K,[e("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:u=>d.openUpdateModal(a)},X,8,Q),e("button",{type:"button",class:"btn bg-light btn-sm waves-effect mx-1",onClick:u=>{o.delete_row_id=a.id},"data-bs-toggle":"modal","data-bs-target":"#DeleteRow"},tt,8,Y)])])]))),128))])]),e("div",et,[e("div",at,[V(e("select",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=a=>o.per_page=a),onChange:t[1]||(t[1]=(...a)=>d.pageCount&&d.pageCount(...a))},ot,544),[[k,o.per_page]])]),e("nav",lt,[e("ul",it,[o.pagination.current_page>1?(l(),i("li",nt,[e("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=a=>d.loadPage(o.pagination.current_page-1))},"Précédent")])):v("",!0),(l(!0),i(c,null,_(o.pagination.last_page,a=>(l(),i("li",{class:F(["page-item",{active:a===o.pagination.current_page}]),key:a},[e("a",{class:"page-link",href:"#",onClick:u=>d.loadPage(a)},g(a),9,dt)],2))),128)),o.pagination.current_page<o.pagination.last_page?(l(),i("li",rt,[e("a",{class:"page-link",href:"#",onClick:t[3]||(t[3]=a=>d.loadPage(o.pagination.current_page+1))},"Suivant")])):v("",!0)])])])])):o.loading?(l(),i("div",pt,mt)):(l(),i("div",ct,_t)),e("div",gt,[e("form",{onSubmit:t[10]||(t[10]=y((...a)=>d.submitFormUpdate&&d.submitFormUpdate(...a),["prevent"]))},[e("div",ft,[e("div",bt,[vt,e("div",yt,[r(b,{modelValue:s.PhaseId,"onUpdate:modelValue":t[4]||(t[4]=a=>s.PhaseId=a),value:o.formData.PhaseId,apiUrl:"https://api.gestion-livraison.pro/api/order/phases",fieldName:"Nom",first_option:"Selectionner la Phase",label:"Phase",Class_Content:"col-md-12 mt-4","onUpdate:value":t[5]||(t[5]=a=>o.formData.PhaseId=a)},null,8,["modelValue","value"]),r(h,{modelValue:s.Nom,"onUpdate:modelValue":t[6]||(t[6]=a=>s.Nom=a),label:"Statut",type:"text",Class_Content:"col-md-12 mt-4",value:o.formData.Nom,"onUpdate:value":t[7]||(t[7]=a=>o.formData.Nom=a)},null,8,["modelValue","value"]),r(h,{modelValue:s.Coleur,"onUpdate:modelValue":t[8]||(t[8]=a=>s.Coleur=a),label:"Coleur",type:"color",Class_Content:"col-md-12 mt-4",value:o.formData.Coleur,"onUpdate:value":t[9]||(t[9]=a=>o.formData.Coleur=a)},null,8,["modelValue","value"])]),Dt])])],32)]),e("div",Ct,[e("form",{onSubmit:t[17]||(t[17]=y((...a)=>d.submitFormAdd&&d.submitFormAdd(...a),["prevent"]))},[e("div",wt,[e("div",Ut,[Pt,e("div",St,[r(b,{modelValue:s.PhaseId,"onUpdate:modelValue":t[11]||(t[11]=a=>s.PhaseId=a),value:o.formData.PhaseId,apiUrl:"https://api.gestion-livraison.pro/api/order/phases",fieldName:"Nom",first_option:"Selectionner la Phase",label:"Phase",Class_Content:"col-md-12 mt-4","onUpdate:value":t[12]||(t[12]=a=>o.formData.PhaseId=a)},null,8,["modelValue","value"]),r(h,{modelValue:s.Nom,"onUpdate:modelValue":t[13]||(t[13]=a=>s.Nom=a),label:"Statut",type:"text",Class_Content:"col-md-12 mt-4",value:o.formData.Nom,"onUpdate:value":t[14]||(t[14]=a=>o.formData.Nom=a)},null,8,["modelValue","value"]),r(h,{modelValue:s.Coleur,"onUpdate:modelValue":t[15]||(t[15]=a=>s.Coleur=a),label:"Coleur",type:"color",Class_Content:"col-md-12 mt-4",value:o.formData.Coleur,"onUpdate:value":t[16]||(t[16]=a=>o.formData.Coleur=a)},null,8,["modelValue","value"])]),It])])],32)]),r(D,{apiUrl:`https://api.gestion-livraison.pro/api/order/status/${o.delete_row_id}/delete`,onDeletedId:t[18]||(t[18]=a=>o.deletedRow=a)},null,8,["apiUrl"])],64)}const kt=w(z,[["render",Vt],["__scopeId","data-v-70149713"]]),Ft={class:"main-content"},Nt={class:"page-content"},xt={class:"container-fluid"},Mt={class:"card"},At={class:"card-body"},jt={class:"mb-3"},qt={data(){return{formData:{Phase:"",Nom:"",Coleur:""}}}},Ht=Object.assign(qt,{__name:"orders_status",setup(s){const t=A(null);return(n,m)=>(l(),i("div",Ft,[e("div",Nt,[e("div",xt,[r(C,{pageTitle:"Liste des Statuses",toggle:"modal",target:"#modalAdd",modalText:"Nouveau Statut"}),e("div",Mt,[e("div",At,[e("div",jt,[r(L,{placeholder:"Rechercher par Motcle",onFilterUpdated:m[0]||(m[0]=o=>t.value=o),filters_fields:"search,orderStatusPhase"})]),r(kt,{apiUrl:"https://api.gestion-livraison.pro/api/order/status",filters_update:t.value,hidden_columns:["PhaseId","id"]},null,8,["filters_update"])])])])])]))}});export{Ht as default};
